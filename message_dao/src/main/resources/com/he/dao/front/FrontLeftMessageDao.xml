<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.he.dao.front.FrontLeftMessageDao">
    <insert id="saveLeftMessage">
        insert into front_left_message(leader_id,user_id,type_id,
        field,title,passage,ask_passage,extra_passage,is_process,time)
        values (#{leaderId},#{userId},#{typeId},#{field},#{title},
        #{passage},#{askPassage},#{extraPassage},#{isProcess},#{time})
    </insert>

    <select id="findByLeaderId" resultType="map">
        SELECT
            id id,
            leader_id leaderId,
            user_id userId,
            CASE type_id
            WHEN '1'  THEN '咨询'
            WHEN '5' THEN '建言'
            WHEN '2' THEN '投诉'
            WHEN '6' THEN '求助'
            WHEN '9' THEN '感谢'
            END typeId,
            field field,
            title title,
            left(passage,120) passage,
            ask_passage askPassage,
            extra_passage extraPassage,
            CASE is_process
            WHEN 'true'  THEN '已回复'
            WHEN 'false' THEN '待回复'
            END isProcess,
            DATE_FORMAT( time, '%Y-%m-%d %H:%i:%S' ) time
        FROM
            front_left_message where leader_id=#{id}
    </select>
</mapper>