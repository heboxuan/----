!function(t,p){var e=t.sjPager={opts:{pageSize:10,preText:"上一页",nextText:"下一页",url:"",type:"post",dataType:"json",searchParam:{},showJump:!1,beforeSend:null,success:null,complete:null,error:function(){alert("request error, try again.")},pageIndex:1,totalCount:-1,totalPage:0},pagerElement:null,commonHtmlText:{currentPageItem:"<a class='current'> {0} </a>",pageItem:"<a href='javascript:void(0)' onclick='sjPager.doPage({0},{1})'>{2}</a>"},init:function(t,e){var a=this;return a.opts=p.extend({},a.opts,e),a.pagerElement=t,a.doPage(a.opts.pageIndex,a.opts.pageSize),a},reload:function(t){var e=this;e.opts.pageIndex=1,e.opts.totalCount=-1,e.opts.totalPage=0,e.opts.searchParam=t,e.doPage(e.opts.pageIndex,e.opts.pageSize)},doPage:function(t,e){var o=this;o.opts.pageIndex=t,o.opts.pageSize=e,p.ajax({type:o.opts.type,data:p.extend(o.opts.searchParam||{},{page:o.opts.pageIndex,rows:o.opts.pageSize||10,total:o.opts.totalCount}),dataType:o.opts.dataType,url:o.opts.url,beforeSend:function(){o.opts.beforeSend()},error:function(t,e,a){o.opts.error(t,e,a)},success:function(t){if(o.opts.success(t),-1==o.opts.totalCount&&(o.opts.totalCount=t.responseData.total,null!=t.responseData.totalPage&&null!=t.responseData.totalPage?o.opts.totalPage=t.responseData.totalPage:o.getTotalPage()),o.opts.pageIndex>o.opts.totalPage&&(o.opts.pageIndex=o.opts.totalPage),o.opts.pageIndex<1&&(o.opts.pageIndex=1),0<o.opts.totalCount){var e=o.createPages();o.pagerElement.html(e)}else o.pagerElement.html("")},complete:function(){o.opts.complete()}})},getTotalPage:function(){var t=this;t.opts.totalPage=Math.ceil(t.opts.totalCount/t.opts.pageSize)},getPageToStart:function(){var t=this,e=0<t.opts.totalPage-9?t.opts.totalPage-9:1,a=0<t.opts.pageIndex-3?t.opts.pageIndex-3:1;return a=a<e?a:e},getPageToEnd:function(){var t=this;if(t.opts.totalPage<10)return t.opts.totalPage;var e=t.opts.pageIndex+3;return e=(e=e>t.opts.totalPage?t.opts.totalPage:e)<10?10:e},createPageFromTo:function(t,e){for(var a="",o=t;o<=e;o++)a+=this.getPageItem(o,o+"");return a},getPageItem:function(t,e){var a=this;return a.opts.pageIndex==t?a.stringFormat(a.commonHtmlText.currentPageItem,e):a.stringFormat(a.commonHtmlText.pageItem,t,a.opts.pageSize,e)},createPages:function(){var t=this,e="",a=t.getPageToStart(),o=t.getPageToEnd();return 1<t.opts.pageIndex&&(e+=t.getPageItem(t.opts.pageIndex-1,t.opts.preText)),2==a&&(e+=t.getPageItem(1,"1")),2<a&&(e+=t.getPageItem(1,"1"),e+="<i>...</i>"),e+=t.createPageFromTo(a,o),o==t.opts.totalPage-1&&(e+=t.getPageItem(t.opts.totalPage,t.opts.totalPage)),o<t.opts.totalPage-1&&(e+="<i>...</i>",e+=t.getPageItem(t.opts.totalPage,t.opts.totalPage)),t.opts.pageIndex<t.opts.totalPage&&(e+=t.getPageItem(t.opts.pageIndex+1,t.opts.nextText)),t.opts.showJump&&(e+="<i>&nbsp;共"+t.opts.totalCount+"条&nbsp;</i>",e+="跳转到<input name='jumpPageNum' id='jumpPageNum' style='width:20px:height:16px' size='2'>页<input type='button' value='go' style='width:22px;height:21px' onclick='sjPager.doPage((parseInt($(\"#jumpPageNum\").val())?parseInt($(\"#jumpPageNum\").val()):1),"+t.opts.pageSize+")'>"),e},stringFormat:function(){if(0==arguments.length)return null;for(var t=arguments[0],e=1;e<arguments.length;e++){var a=new RegExp("\\{"+(e-1)+"\\}","gm");t=t.replace(a,arguments[e])}return t}};p.fn.sjAjaxPager=function(t){e.init(p(this),t)}}(window,jQuery);