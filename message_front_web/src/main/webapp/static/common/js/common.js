var CONTEXT_PATH;Date.prototype.format=function(t){var e={"M+":this.getMonth()+1,"d+":this.getDate(),"H+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};for(var n in/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),e)new RegExp("("+n+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?e[n]:("00"+e[n]).substr((""+e[n]).length)));return t},jQuery.validator.setDefaults({ignore:[],success:function(t){var e=$(t).attr("data-tipid");null==e&&""==e||layer.close(e)},errorPlacement:function(t,e){var n,r,a=$(e),i=a.attr("data-tipid");null==i&&""==i||layer.close(i),t.is(":empty")||(n=(n=a.attr("id")).replace(".","\\."),0<$("#"+n+"-error").length&&(n+="-error"),r=layer.tips(t.html(),"#"+n,{time:6e4,tips:[2,"#FF6666"],tipsMore:!0,anim:!1}),a.attr("data-tipid",r))}}),jQuery.validator.addMethod("validEmail",function(t){return""==t||Common.isEmail(t)}),jQuery.validator.addMethod("validPhone",function(t,e){return""==t||Common.isPhone(t)},"请输入正确的手机号码"),jQuery.validator.addMethod("validChineseName",function(t){return""==t||Common.isChineseName(t)}),jQuery.validator.addMethod("validPassword",function(t){return""==t||!Common.isPassword(t)}),jQuery.validator.addMethod("maxBLen",function(t,e,n){var r=Common.getByteLen(t);return this.optional(e)||r<=n}),jQuery.validator.addMethod("minBLen",function(t,e,n){var r=Common.getByteLen(t);return this.optional(e)||n<=r}),jQuery.validator.addMethod("validCertification",function(t,e,n){return""==t||Common.validateIdCard(t)});var Ajax={};function _doWithResult(e,t){"need_login"!=e.result?("wap_need_login"==e.result&&User.login.openLoginBox(),"invalid_access"!=e.result?t(e):layer.alert(e.responseData,{icon:5},function(t){location.href=CONTEXT_PATH+"/forbidden"})):layer.alert(e.responseData,{icon:5},function(t){0<=e.message.indexOf("referer|")?(e.message.replace("referer|",""),location.href=CONTEXT_PATH+"/login?referer="+e.message.replace("referer|","")):location.href=CONTEXT_PATH+"/login"})}Ajax.get=function(t,e,n){jQuery.isFunction(e)&&(n=e,e=void 0),$.get(t,e,function(t){_doWithResult(t,n)},"json")},Ajax.post=function(t,e,n){jQuery.isFunction(e)&&(n=e,e=void 0),$.post(t,e,function(t){_doWithResult(t,n)},"json")},Ajax.postJson=function(t,e,n){jQuery.isFunction(e)&&(n=e,e=void 0),$.ajax({type:"POST",contentType:"application/json",url:t,dataType:"json",data:e,success:function(t){_doWithResult(t,n)},error:function(){layer.alert("出错了！",{icon:5},function(t){location.reload()})}})},Ajax.formAjaxSubmit=function(t,n){var e={dataType:"json",success:function(t,e){_doWithResult(t,n)},error:function(t){layer.alert("出错了！",{icon:5},function(t){location.reload()})},clearForm:!1,timeout:6e4};$(t).ajaxSubmit(e)};var Common={isEmail:function(t){return/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/.test(t)},isPhone:function(t){return/^1\d{10}$/g.test(t)},isChineseName:function(t){return/^[\u4e00-\u9fa5]{1,10}(\u00b7[\u4e00-\u9fa5]{1,10})*$/.test(t)},isPassword:function(t){return/[\'\"\\]/.test(t)},isCertificationNo:function(t){return/(^\d{18}$)|(^\d{17}(\d|X|x)$)/.test(t)},validateIdCard:function(t){return!1!==isCardNo(t)&&(!1!==checkProvince(t)&&(!1!==checkBirthday(t)&&!1!==checkParity(t)))}},vcity={11:"北京",12:"天津",13:"河北",14:"山西",15:"内蒙古",21:"辽宁",22:"吉林",23:"黑龙江",31:"上海",32:"江苏",33:"浙江",34:"安徽",35:"福建",36:"江西",37:"山东",41:"河南",42:"湖北",43:"湖南",44:"广东",45:"广西",46:"海南",50:"重庆",51:"四川",52:"贵州",53:"云南",54:"西藏",61:"陕西",62:"甘肃",63:"青海",64:"宁夏",65:"新疆",71:"台湾",81:"香港",82:"澳门",91:"国外"};isCardNo=function(t){return!1!==/(^\d{15}$)|(^\d{17}(\d|X)$)/.test(t)},checkProvince=function(t){var e=t.substr(0,2);return null!=vcity[e]},checkBirthday=function(t){var e=t.length;if("15"==e){var n=(o=t.match(/^(\d{6})(\d{2})(\d{2})(\d{2})(\d{3})$/))[2],r=o[3],a=o[4],i=new Date("19"+n+"/"+r+"/"+a);return verifyBirthday("19"+n,r,a,i)}if("18"!=e)return!1;var o,n=(o=t.match(/^(\d{6})(\d{4})(\d{2})(\d{2})(\d{3})([0-9]|X)$/))[2],r=o[3],a=o[4],i=new Date(n+"/"+r+"/"+a);return verifyBirthday(n,r,a,i)},verifyBirthday=function(t,e,n,r){var a=(new Date).getFullYear();if(r.getFullYear()!=t||r.getMonth()+1!=e||r.getDate()!=n)return!1;var i=a-t;return 0<=i&&i<=130},checkParity=function(t){if("18"!=(t=changeFivteenToEighteen(t)).length)return!1;for(var e=new Array(7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2),n=new Array("1","0","X","9","8","7","6","5","4","3","2"),r=0,a=0;a<17;a++)r+=t.substr(a,1)*e[a];return n[r%11]==t.substr(17,1)},changeFivteenToEighteen=function(t){if("15"!=t.length)return t;var e,n=new Array(7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2),r=new Array("1","0","X","9","8","7","6","5","4","3","2"),a=0;for(t=t.substr(0,6)+"19"+t.substr(6,t.length-6),e=0;e<17;e++)a+=t.substr(e,1)*n[e];return t+=r[a%11]},Common.getByteLen=function(t){for(var e=t.length,n=0;n<t.length;n++)127<t.charCodeAt(n)&&e++;return e},Common.getCharLen=function(t){return t.replace("[^\0-ÿ]/g","aa").length},Common.getWordCount=function(t){var e=t.replace(/[\u4e00-\u9fa5]/g,"").length;return e+(t.length-e)},Common.getFormJsonData=function(id){var arr=$("#"+id).serializeArray(),str="({";return $.each(arr,function(t,e){str+="'"+e.name+"':'"+$.trim(e.value)+"', "}),0<str.length&&(str=str.substring(0,str.length-2)),str+="})",obj=eval(str),obj},Common.selectAllCheckbox=function(t,e){1==$(t).attr("checked")?$("input[name='"+e+"']").attr("checked",!0):$("input[name='"+e+"']").attr("checked",!1)},Common.loadPage=function(t,e,n){$("#"+t).empty(),$("#"+t).append("<div align='center'><img src='-+CONTEXT_PATH+-/static/www/images/loading.gif'/*tpa=http://liuyan.people.com.cn/static/common/js/"+CONTEXT_PATH+"/static/www/images/loading.gif*//></div>"),$("#"+t).load(e,n)},Common.addAnchorByParams=function(t,e){var n="";if(null!=e)for(var r in e){var a=e[r];null!=t[a]&&(n+=a+"="+encodeURIComponent(t[a])+"&")}var i=location.href;-1!=i.indexOf("#")&&(i=i.substring(0,i.indexOf("#"))),""!=n&&(n=n.substring(0,n.length-1),location.href=i+"#"+n)},Common.getPageParamsByAnchor=function(t){var e={},n={},r=location.href,a=0;if(-1!=r.indexOf("?")&&(a=r.indexOf("?")),-1!=r.indexOf("#",a)&&r.indexOf("#",a)!=r.length-1){var i=(r=r.substr(r.indexOf("#",a)+1)).split("&");for(var o in i){var l,s=i[o].split("=");2==s.length&&("page"!=s[0]?""!=$.trim(s[1])&&(n[$.trim(s[0])]=decodeURIComponent($.trim(s[1]))):(l=parseInt(s[1]),(isNaN(l)||l<1)&&(l=1),e.page=l))}}var u={};if(null!=t)for(var d in t)null!=n[t[d]]&&(u[t[d]]=n[t[d]]);return e.queryParam=u,null==e.page&&(e.page=1),e},Common.addAnchorByAjaxPageParams=function(t){var e="";if(null!=t)for(var n in t){var r=t[n];null!=sjPager.opts.searchParam[r]&&(e+=r+"="+encodeURIComponent(sjPager.opts.searchParam[r])+"&")}0<sjPager.opts.pageIndex&&(e+="page="+sjPager.opts.pageIndex+"&");var a=location.href;-1!=a.indexOf("#")&&(a=a.substring(0,a.indexOf("#"))),""!=e&&(e=e.substring(0,e.length-1),location.href=a+"#"+e)},Common.getPageParamsByRequest=function(t){var e={},n=location.href;if(-1!=n.indexOf("?")&&n.indexOf("?")!=n.length-1){var r=(n=-1!=n.indexOf("#")?n.substring(n.indexOf("?")+1,n.indexOf("#")):n.substr(n.indexOf("?")+1)).split("&");for(var a in r){var i=r[a].split("=");2==i.length&&""!=$.trim(i[1])&&(e[$.trim(i[0])]=decodeURIComponent($.trim(i[1])))}}var o={};if(null!=t)for(var l in t)null!=e[t[l]]&&(o[t[l]]=e[t[l]]);return o},Common.locateUrlByParams=function(t,e){var n="";if(null!=e)for(var r in e){var a=e[r];null!=t[a]&&""!=t[a]&&(n+=a+"="+encodeURIComponent(t[a])+"&")}var i=location.href;-1!=i.indexOf("#")&&(i=i.substring(0,i.indexOf("#"))),-1!=i.indexOf("?")&&(i=i.substring(0,i.indexOf("?"))),""!=n&&(n=n.substring(0,n.length-1),location.href=i+"?"+n)},Common.loadAllAdvs=function(){$(".adv-data").each(function(){var a=$(this),t=$(this).attr("data-advpid");$.ajax({url:CONTEXT_PATH+"/files/data/adv_pos_"+t+".json",dataType:"json",success:function(t){a.empty();for(var e=0;e<t.length;e++){var n,r=t[e];try{"code"http://liuyan.people.com.cn/static/common/js/==r.type?a.append(r.code):"olimg"http://liuyan.people.com.cn/static/common/js/==r.type?(n="<a href='"+r.link+"' target='_blank'><img src='"+r.url+"'",null!=r.width&&""!=r.width&&(n+=" width='"+r.width+"'"),null!=r.height&&""!=r.height&&(n+=" height='"+r.height+"'"),null!=r.txt&&""!=r.txt&&(n+=" alt='"+r.txt+"'"),n+="/></a>",a.append(n)):"lcimg"http://liuyan.people.com.cn/static/common/js/==r.type?(n="<a href='"+r.link+"' target='_blank'><img src='"+CONTEXT_PATH+"/"+r.url+"'",null!=r.width&&""!=r.width&&(n+=" width='"+r.width+"'"),null!=r.height&&""!=r.height&&(n+=" height='"+r.height+"'"),null!=r.txt&&""!=r.txt&&(n+=" alt='"+r.txt+"'"),n+="/></a>",a.append(n)):"text"==r.type&&(n="<a href='"+r.link+"' target='_blank'>"+r.txt+"</a>",a.append(n))}catch(t){a.empty()}}},error:function(t){a.empty()}})})};